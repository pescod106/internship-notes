### 乐观锁

假设认为数据一般情况下不会造成冲突,所以在进行数据库更新的时候,才会正式对数据的冲突与否进行检测,如果冲突了,则返回用户错误的消息,让用户决定如何去做

乐观锁的两种方式:

1. 使用数据库版本记录机制实现,数据版本即为数据增加一个版本表示,一般是通过为数据库表增加一个数据类型的version字段来实现,当读取数据时,将version字段值一同读出,数据美更新一次看,对此version值加一,当我们提交更新的时候,判断数据库表对应的记录的当前版本信息与第一次取出来的version值进行对比,如果数据库当前版本号与第一次的version值相同,则予以更新,否则认为是过期数据
2. 第二种乐观锁的实现机制与第一种差不多,同样在需要乐观锁控制的table中增加一个字段,名称无所谓,字段类型使用时间戳,和上面的version类似,也在更新提交的时候检查当前数据库的时间戳与自己更新前渠道的时间戳进行对比,如果一致则OK,否则就是版本冲突

### AOP

    AOP把软件系统分为两个部分,核心关注点和横切关注点.业务处理的主要流程是核心关注点,一直关系不大的部分是横切关注点.横切关注点的一个特定是,他们经常发生在和核心关注点的多处,而各处基本相似.比如权限认证、日志、事务处理.Aop的作用在于分离系统中的各种关注点,将核心关注点和横切关注点分离开来.

    实现AOP的技术主要分为两类:一类是采用动态代理技术,利用截取消息的方式,对该消息进行装饰,以取代原有对象的执行;二是采用静态植入的方式,引入特定语法创建"方面",从而使得编译器可以在编译期间植入有关"方面"的代码.

### 静态代理

1. 静态代理的角色分析
   1. 抽象角色------一般使用接口或抽象类来实现
   2. 真实角色------被代理角色
   3. 代理角色------代理真实角色---代理真是角色后一般会做一些附属操作
   4. 客户        ------使用代理角色来进行一些操作

2. 类图

![](/assets/静态代理.png)
3. 使用静态代理的好处
* 使得真实角色处理的业务更加纯粹,不再去关注一些公共的事情.
* 公共的业务有代理来完成---实现了业务的分工
* 公共业务发生扩展改变时,变得更加集中和方便

缺点:
* 类多了---多了代理类,工作量大,开发效率低

### 动态代理





